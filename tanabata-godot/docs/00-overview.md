# Обзор проекта Tanabata (Godot)

## Что это

Tanabata — 2D Tower Defense игра на гексагональной карте. Портируется с версии на Go. Игрок строит башни, выбирает какие сохранить, затем отражает волны врагов.

## Главные идеи

- **Карта** — гексы с точкой входа, выходом и чекпоинтами.
- **Башни** — майнеры (дают энергию), атакующие (стреляют по врагам), стены (блокируют).
- **Энергосеть** — атакующие башни работают только при доступе к энергии от майнеров.
- **Фазы** — строительство → выбор башен → волна врагов → снова строительство.

## Структура проекта

- **core/** — логика, не зависящая от Godot.
- **godot_adapter/** — связка с Godot (рендер, UI, ввод).
- **autoload/** — синглтоны (Config, GameManager, Profiler).
- **data/** — JSON с определениями башен, врагов, волн.
- **scenes/** — главные сцены Godot.

## Поток работы

1. Запуск — загрузка данных, генерация карты и руды, создание энергосети.
2. BUILD — игрок ставит до 5 башен, майнеры должны быть на руде.
3. SELECTION — игрок отмечает 2 башни, остальные превращаются в стены.
4. WAVE — враги идут от входа к выходу, башни стреляют.
5. Когда все враги убиты — снова BUILD.

## Реализовано

Подробный список — см. [IMPLEMENTED.md](IMPLEMENTED.md). Кратко: карта, фазы, энергосеть, руда, волны, движение, бой (PROJECTILE/LASER/AOE/BEACON), статус-эффекты (slow, poison, jade_poison), крафт, Recipe Book (B), Volcano, Lighthouse, Silver (лазер + slow), Malachite (impact burst + homing осколки), Jade (стакающийся яд). Путь врагов: A* с min-heap и дебаунсом пересчёта; для летающих — условная вставка центра. Снаряды: потиковая донаводка при приближении к цели. **MVP** — бафф урона башен (0–5), +1 за топ по урону за волну (не при пропуске волны). **Уклонение** врагов (evasion) и **способности** из ability_definitions.json. Данные загружаются через DataRepository; баланс правят в towers.json/waves.json (см. правило в [21-data-json](21-data-json.md)).
