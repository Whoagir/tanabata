# Фазы игры

## Три фазы

В коде (`GameTypes.GamePhase`): **BUILD_STATE**, **TOWER_SELECTION_STATE**, **WAVE_STATE**. В тексте доки для краткости: BUILD, SELECTION, WAVE.

1. **BUILD** — строительство.
2. **TOWER_SELECTION** — выбор башен.
3. **WAVE** — волна врагов.

Переключение: BUILD → SELECTION → WAVE → BUILD.

---

## BUILD (строительство)

**Что делает игрок:**
- Ставит башни кликом левой кнопкой.
- Удаляет башни правой кнопкой.
- Максимум 5 «обычных» башен за фазу (дебаг-башни не считаются).

**Правила:**
- Башня ставится только на проходимый тайл с возможностью размещения.
- Стены не участвуют в энергосети.
- После 5 обычных башен фаза автоматически переключается в SELECTION.

**Режим отладки:**
- Клавиши 1, 2, 3 задают тип башни в обход лимита.
- Клавиша 1 — случайная атакующая.
- Клавиша 2 — майнер.
- Клавиша 3 — стена.

---

## TOWER_SELECTION (выбор башен)

**Что делает игрок:**
- Кликает по башням, чтобы отметить их для сохранения.
- Нужно выбрать 2 башни из 5 временных.
- Клик по индикатору фазы переводит в WAVE.

**Правила:**
- Невыбранные временные башни превращаются в стены.
- Выбранные становятся постоянными.
- Майнеры считаются выбранными по умолчанию.
- Если перейти в WAVE без выбора двух башен — все невыбранные превращаются в стены (остаются 0–2 башни в зависимости от выбора).

---

## WAVE (волна)

**Что происходит:**
- Спавнятся враги по таймеру.
- Враги идут по пути через чекпоинты (A*).
- Активные атакующие башни стреляют по врагам.
- Враги получают урон, умирают.
- Когда все враги заспавнены и убиты — волна завершается.

**Переход:**
- Волна завершена → фаза BUILD.
- Счётчик башен сбрасывается.
- Можно строить следующие 5 башен.

---

## Индикатор фазы

Круг в правом верхнем углу показывает текущую фазу цветом:
- Синий — BUILD.
- Жёлтый — SELECTION.
- Красный — WAVE.

Клик по индикатору переводит на следующую фазу (вручную).
