# Архитектура проекта

## Слои

### 1. Core (ядро)

Содержит логику игры без привязки к Godot:

- ECS мир (сущности, компоненты)
- Гексагональная математика
- Генерация карты
- Поиск пути
- Системы: ввод, волны, бой, снаряды, движение, энергосеть, руда, статус-эффекты, крафт, вулкан, маяк

### 2. Godot Adapter (адаптер)

Связывает core с Godot:

- Рендеринг (башни, враги, снаряды, стены, линии, руда)
- UI (HUD, кнопки, индикаторы, книга рецептов)
- Ввод (мышь, клавиатура)
- Пул объектов для оптимизации

### 3. Autoload (синглтоны)

- **Config** — константы, настройки, формулы.
- **GameManager** — ECS, карта, системы, данные, загрузка.
- **Profiler** — замер времени выполнения (опционально).

## Порядок инициализации

1. Godot загружает autoload-скрипты.
2. GameManager создаёт ECS, карту, загружает JSON.
3. GameManager генерирует руду и создаёт энергосеть.
4. Главная сцена создаёт системы и рендереры.
5. Каждый кадр: ввод → системы → рендер.

## Главный цикл

- Обработка ввода (клики, клавиши).
- Обновление систем (волны, движение, бой, снаряды) с учётом скорости времени.
- Рендеринг (карта, сущности, эффекты).
- Обновление UI.
