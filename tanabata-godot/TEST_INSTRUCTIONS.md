# Инструкция по тестированию

## Что сейчас работает

После всех изменений в игре работает:

### 1. Визуализация карты
- Гексагональная карта генерируется
- **START** (зеленый) - точка входа
- **EXIT** (красный) - точка выхода
- **Чекпоинты 1-6** (оранжевые с цифрами)

### 2. Размещение башен
- **ЛКМ** - поставить башню на гекс
- **ПКМ** - убрать башню
- Лимит 5 башен в фазе BUILD
- Случайный выбор башни из loot table
- Башни отображаются как цветные квадраты

### 3. Фазы игры
- **BUILD** - строительство (начальная фаза)
- **WAVE** - волна врагов
- **Пробел** или кнопка - начать волну

### 4. Враги
- Спавнятся по таймеру
- Двигаются по пути через чекпоинты
- Проходят: START → CP1 → CP2 → ... → CP6 → EXIT
- При достижении EXIT наносят урон игроку
- Размер уменьшается при получении урона (визуально)

### 5. UI
- **Здоровье игрока** (зеленый/желтый/красный)
- **Номер волны**
- **Фаза игры** (BUILD/WAVE)
- **Счетчик башен** (X/5)
- Кнопка "Start Wave"
- Подсказки внизу

### 6. Управление
- **WASD** - двигать камеру
- **R/T** - приближать/отдалять
- **Y** - сбросить zoom
- **Пробел** - начать волну
- **F12** - вывести состояние в консоль
- **F10** - God Mode
- **F3** - Visual Debug

---

## Как протестировать

### Тест 1: Размещение башен
1. Запусти игру (F5)
2. Кликни ЛКМ по гексу - должна появиться цветная башня
3. Поставь еще 4 башни (всего 5)
4. Попытайся поставить 6-ю - должно написать "limit reached"
5. Кликни ПКМ по башне - она удалится
6. Счетчик "Towers: X/5" должен обновляться

### Тест 2: Начало волны
1. Поставь хотя бы 1 башню
2. Нажми **Пробел** или кнопку "Start Wave"
3. Фаза должна смениться на **WAVE**
4. Через 0.8 сек начнут появляться враги у **START**

### Тест 3: Движение врагов
1. Начни волну
2. Враги должны появляться у зеленого START
3. Они должны двигаться к первому чекпоинту (оранжевый с цифрой "1")
4. Затем ко второму ("2"), третьему ("3") и т.д.
5. В консоли будет выводиться "Enemy X reached checkpoint Y"
6. После прохождения всех 6 чекпоинтов враги идут к EXIT (красный)
7. При достижении EXIT враг исчезает, а здоровье игрока уменьшается

### Тест 4: Завершение волны
1. Дождись пока все враги заспавнятся (5 врагов)
2. Дождись пока все враги дойдут до EXIT
3. Фаза должна автоматически вернуться в **BUILD**
4. Волна увеличится (Wave: 1 → Wave: 2)
5. Счетчик башен сбросится (Towers: 0/5)

### Тест 5: Несколько волн
1. Пройди тест 1-4
2. Поставь новые башни
3. Начни волну 2
4. Должно появиться 7 врагов (из waves.json)
5. После волны 2 → волна 3 (9 врагов)
6. И так далее до волны 10

### Тест 6: Здоровье игрока
1. Начни волну
2. Дождись пока враги дойдут до EXIT
3. Здоровье должно уменьшиться (каждый враг наносит ~20 урона)
4. Цвет "Health" меняется:
   - Зеленый при >50
   - Желтый при 25-50
   - Красный при <25
5. При здоровье ≤0 (без God Mode) в консоли "GAME OVER!"

---

## Известные проблемы и TODO

### Что пока не работает:
- **Башни не стреляют** (CombatSystem еще не реализована)
- **Нет снарядов** (ProjectileSystem еще не реализована)
- **Враги не умирают** (нет урона от башен)
- **Нет энергосети** (все башни активны всегда)
- **Нет крафта** (нельзя комбинировать башни)
- **Нет руды** (руды не генерируются)
- **Нет фазы SELECTION** (не нужно выбирать башни для сохранения)

### Баги:
- Враги могут проходить через башни (collision не реализован)
- Башни выглядят как квадраты (нет спрайтов)
- Враги выглядят как квадраты (нет спрайтов)
- При клике может быть небольшое смещение (координаты камеры)

---

## Следующие шаги

### Приоритет 1 (для базового геймплея):
1. **CombatSystem** - башни находят цели и стреляют
2. **ProjectileSystem** - снаряды летят к врагам
3. **Урон врагам** - враги получают урон и умирают
4. **Простые спрайты** - заменить квадраты на картинки

### Приоритет 2:
5. Энергосеть (башни работают только если подключены)
6. Крафт башен
7. Руда
8. Визуальные эффекты

---

## Что уже хорошо работает

- **Процедурная генерация карты** - каждый раз новая
- **Pathfinding через чекпоинты** - враги идут по правильному пути
- **Фазы игры** - автоматическая смена BUILD → WAVE → BUILD
- **UI** - всё видно и понятно
- **Размещение башен** - интуитивно
- **Движение врагов** - плавное и правильное

---

## Советы по тестированию

1. **Открой консоль** (View → Output) чтобы видеть что происходит
2. **Жми F12** чтобы вывести состояние игры
3. **Используй F10 (God Mode)** если хочешь тестировать без урона
4. **Двигай камеру (WASD)** чтобы следить за врагами
5. **Ставь башни у чекпоинтов** - так враги будут дольше идти

---

## Запуск

1. Открой Godot 4.5+
2. Открой проект `tanabata-godot/project.godot`
3. Нажми **F5** (Run)
4. Наслаждайся!

**Удачи в тестировании!**
