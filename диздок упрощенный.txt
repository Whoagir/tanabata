
ИТОГОВЫЙ ДИЗАЙН-ДОК (упрощённый для визуала и дизайна)

1) Что это за игра
- Жанр: 3D Tower Defense на гекс-сетке.
- Фишки: лабиринт по чекпоинтам, энергосеть от руды (без энергии выстрела нет), крафт 3→1 по книге рецептов.
- Фазы раунда: Строительство → Выбор (2 сохранения, остальные 3 превращаются в стены) → Волна (можно крафтить, башни стреляют).
- Цель: растянуть путь и сформировать “килл-зону” в центре, куда сходятся линии огня и энергия.

2) Карта и путь (визуал и логика)
- Сетка-гекс, примерно 2.6 м по диагонали (для масштаба).
- Режим (почти беск.): около 700 гексов, 1 вход, 6 чекпоинтов, 1 выход.
- Высоты — декоративные (перепады не мешают перемещению).
- Путь: Вход → КП1 → КП2 → КП3 → КП4 → КП5 → КП6 → Выход. Враг “касается” центра гекса КП.
- Полное перекрытие пути запрещено (валидация есть).
- A* без учета высоты (препятствия: стены и башни).

3) Энергосеть и руда (визуал и правила)
- 3 жилы руды (центральная/средняя/крайняя), по 4–7 гексов каждая. На каждом гексе 15–75 ед. руды. Есть общее “тело руды” на карту и фиксированное распределение по трем жилам.
- Типы:
  - Тип A — атакующие (включая ауры DE, замедление NI, яд NU). Потребляют энергию.
  - Тип B — добыча/передача (майнеры). Ставятся на руду, подают энергию в сеть.
  - Тип D — стены/камни.
- Передача:
  - Дальность майнера растёт вместе с прогрессом (3→4→5 гексов). Связь B→A — соседи (1 гекс). Потерь по дистанции нет. Пропускная способность сети — без ограничений (в MVP).
  - Когда A стреляет, списывается энергия с случайного майнера в этой сети.
- Деградация от числа потребителей:
  - Чем больше A-башен на одной сети, тем слабее урон выстрела. Базово: множитель урона = 0.9^(A-1). Настраивается.
- Бонус “бедной руды”:
  - На 75 ед. руды бонус 1.0x → на 15 ед. руды бонус 1.6x (линейно между). Считается на каждый выстрел, сразу.
- Визуал сети:
  - Канал-руна в земле/стенах, толщина 0.25 м. Цвет — яркий жёлтый (энергия): #FFD300 (акцент), можно #FFC300 в мягком состоянии.
  - При выстреле по каналу пробегает импульс (яркость ×2 от обычного, длина пробега ~8 гексов).
  - При “мало руды”: пульсации чаще, яркость чуть ниже обычной (чтобы был “надрыв”, не перегорел).
  - Быстрый оверлей сети по клавише (покажем источники/магистрали/потребители разными яркостями жёлтого). Источник ярче, потребители с лёгкой белой каймой.

4) Палитры (материалы, урон, статы)
- Базовая палитра мира (набор A):
  - Камень #3A3A3A
  - Земля #6B553B
  - Дерево #5C4630
  - Железо #7A7A7A
  - Медь #B87333
  - Фон мира: между тёмным и средним, ближе к тёмному (осн. фон #1E1E1E—#2A2A2A).
- Энергия и типы урона:
  - Энергосеть (норма): ярко-жёлтый #FFD300
  - Энергосеть (мало руды): #FFC300 с более частыми пульсами
  - Физический урон: тёплый оранж #FF8C00
  - Магический урон: фиолетовый #B35CFF
  - Чистый урон: бело-голубой #E6FBFF
  - Замедление: светло-голубой #A7D8FF
  - Яд: ярко-зелёный #7FFF3C
- Пост-эффекты:
  - Цветокор: тёплый (лёгкий), без кислотных оттенков.
  - Bloom: низкий, только на энергии/ударах.
  - Лёгкий туман (सеро-голубой), плотность низкая, не “съедает” контраст.
- Время суток:
  - Два пресета: “Знойный полдень” (тёплый свет, лёгкая марево-волна над землёй) и “Тёплый закат” (длинные тени, золотистые лучи).
  - Смена (если включена): 15–20 минут на цикл.

5) Башни (язык форм, рост, детали)
- Общая эстетика башен игрока: “Квадрат и брутализм”. Всегда массивное каменное основание + металл/медь сверху. Силуэт смелый, практичный.
- Рост визуально по уровням (только для крафт-ур. 0, уровни 1–5):
  - Высота: +4% за уровень.
  - Ширина/основание: +8% за уровень.
  - Детали по мере роста: появляются/увеличиваются резервуары, усиливаются швы/заклёпки, локально — кристаллы (по вкусу художника). Катушки — не обязательны.
  - Световые акценты “по типу урона” (мелкие глоу-детали у ствола/в швах).
- Силуэты по крафт-уровням:
  - Жёсткого правила “круг/квадрат/треугольник” теперь нет. Оставляем художнику свободу. Допустимо использовать форму основания или тонкую цветовую кайму как “намёк” на тир (не обязательно).
- Спец-визуал:
  - TOWER_MINER (тип B): скрытая шахта, сверху большая шестерня/механизм. Пар при работе, жёлтая эмиссия в швах. “Есть сеть” — мягкое свечение; “нет сети” — свечение гаснет.
  - Стены (тип D): грубая кладка, металлические скобы, местами “вживлённые” руны (если по ним идёт канал).
- Маркеры крафта: над башнями, которые можно объединить по рецепту, висит маленький жёлтый шар/руна (мягкая пульсация, не отвлекает).
- MVP: над башней — золотая шестерёнка (а не корона, под стиль индустрии), число стека внутри: ×1, ×2, … до ×5 (каждый даёт +10% урона). При присвоении — короткая вспышка шестерён/искорок.

6) Атаки, снаряды, VFX
- Снаряды (базово): яркие, короткие трейлы, не длиннее 0.5–0.7 сек по жизни следа. В цветах типов урона (см. палитру).
- Сплит (PA/PE/PO): два снаряда с небольшим расхождением (визуально читается раздвоение). Рикошеты — искры в точках контакта.
- Лазер (Сильвер): узкий плотный луч со “срезом”, без дымки, бело-жёлтый отблеск на цели. В момент выстрела — краткий пик эмиссии в рунах канала.
- Вулкан (AOE): постоянная тёплая пульсация у основания, легкая тепловая рябь, всплески при тиках урона.
- Маяк (секторный луч): непрерывный вращающийся луч чистого урона (бело-голубой), мягкие “гребни” света, угол сектора читаем в плане.
- Замедление (NI): синеватый эффект — мелкие ледяные осколки на ногах/суставах, лёгкий холодный туман.
- Яд (NU): зеленоватые подтеки, микро-споры вокруг, тики урона — короткие зелёные вспышки.
- Метка/подсветка цели (рун. камень): тонкий рунический круг под целью + мягкая эмиссия “вверх”.

7) Враги (силуэты, резисты, сломы)
- Общий язык форм: “Треугольник/углы/асимметрия”, грубая сборка, ржавчина/латунь/сколотый камень. Один яркий “глаз”.
- Дистанция:
  - Далеко — читается контур и “глаз”-точка.
  - Средняя — считываем защитный отлив:
    - Физ. защита высокая (маг. отриц.) — тёплый бронзовый оттенок пластин.
    - Маг. защита высокая (физ. отриц.) — холодный фиолетовый отлив.
  - Близко — видны швы, заклёпки, вскрытые кабели.
- 3 стадии разрушения:
  - 70% HP: мелкие искры, царапины/вмятины.
  - 40% HP: дым, частично отваливаются пластины, искры чаще.
  - 10% HP: сильный дым, треск, “глаз” мерцает/фликерит.
- Без health bar — состояние читается по сломам и “глазу”.

8) UI и UX (простая, тактическая читаемость)
- Стиль: минимализм, тёмные панели, ясные иконки. Без лишних цифр, где можно показать шкалами.
- Раскладка:
  - Вверху слева: здоровье игрока (шкала-трещины), уровень/XP (кольцо/полоса).
  - Вверху справа: номер волны (+ пиктограммы элита/босс, когда появятся).
  - Внизу справа: индикатор фазы (молоток/мечи), Пауза/Скорость, индикатор режима U.
  - Внизу слева: три индикатора жил (по одной шкале на жилу).
- Инфо-панель по клику: иконка типа (A/B/D), 3 шкалы (урон/скорострельность/радиус), у врагов — 2 шкалы (физ/маг броня).
- Книга рецептов:
  - Сетка 4 колонки, карточки: Иконка + Иконка + Иконка = Результат.
  - Фильтр “доступно сейчас”.
  - При крафте — 200–300 мс всплеск рун и вспышка на месте новой башни.
- Оверлей сети: по клавише — затемняем остальное, подсвечиваем сеть. Источники/магистрали/потребители — разной яркостью жёлтого. Активные импульсы видны поверх.
- Индикатор “+враг”: узкий бар у Входа. Зелёные сегменты (+4% за килл), красные штрафы за проход КП (−0.1/−1/−2%). При 100% — короткая вспышка и “+1” над Входом.
- Маркер крафта (повтор): над башнями с доступной комбинацией — жёлтый шар/руна (пульс низкой амплитуды).
- Контролы (минимум):
  - ЛКМ — выбрать/поставить, ПКМ — отмена, колесо — зум, СКМ — вращение.
  - Shift+клик — выбор группы для крафта/сохранения.
  - U — режим линий, B — книга рецептов, F9 — пауза.

9) Геймплей (кратко-сводка)
- Строительство: 5 черновиков. Таймеров нет. Можно ставить/удалять. Цель — нарисовать лабиринт и узлы сети.
- Выбор: 2 действия сохранения (сохранить / апгрейд 2→1 / даунгрейд −1 уровень со случайной сменой типа). Оставшиеся 3 превращаются в стены на месте.
- Волна: враги идут, башни бьют. Крафт 3 разные постоянные башни → новая (по книге). Результат появляется на последней выбранной.
- Башни:
  - Базовые (крафт-0) с уровнями 1–5 (урон/радиус растут, стоимости нет).
  - Крафтовые (крафт-1+): уровней не имеют, только новые рецепты.
- Сеть:
  - Дальность майнеров растёт по ходу рана (3→4→5 гексов).
  - Деградация от количества A-башен в сети (0.9^(A−1)).
  - Бонус “бедной руды” (1.0x при 75 ед. → 1.6x при 15 ед.).
- MVP и усложнение:
  - До 5 MVP-башен, каждая метка +10% урона.
  - Счётчик сложности: +4% за убийство; штраф за КП: −0.1/−1/−2%. При >100% — +1 враг к следующей волне.

10) Примеры башен (из текущего пула)
- Базовые (крафт-0): TA/TE/TO (прямой урон), PA/PE/PO (сплит), DE (аура скорости), NI (замедление), NU (яд).
- Крафт (крафт-1+): Сильвер (лазер, физ), Малахит (магический сплит x3 + взрыв), Вулкан (AOE), Маяк (чистый луч сектором), Нефрит (сильный маг. яд).
- Сервис: TOWER_MINER (майнер), TOWER_WALL (стена).

11) Враги (MVP-пул)
- Примеры (из enemies.json): Слабый/Обычный/Крепкий, Магический щит (маг высокий, физ отрицательный).
- Боссы/особые механики — позже (MVP без них). Визуально — по одному “языку форм”.

12) Данные и структура проекта
- assets/data: towers.json, enemies.json, recipes.json, loot_tables.json.
- defs/loader.go — загрузка JSON.
- config.go — цвета/камеры/баланс/скорости/уроны/лимиты.
- ECS: компоненты аур, боя, снарядов, руды/линий, движения, волн, визу-эффектов.
- Рендер: сначала мир (земля/стены/руда), потом снаряды и UI (поверх).

13) Референсы-вайб (словами)
- Вайб: “Прагматичный Гекстек” — брутальный камень, тёплый металл, руническая энергия. Тактичная ясность, мрачноватая атмосфера, но без “грязи на экране”.
- Вдохновлялись: Arcane (дуализм тех+магии), Kingdom Rush (чёткие VFX), Kingdom Two Crowns (меланхолия), Fieldrunners (читабельность), Dota-карты Gem TD (лабиринт/крафт).

14) Открытые настройки (можно в баланс/конфиг)
- Кап суммарного замедления (позже добавим, рекомендую 60–70%).
- Детали UI (радиусы/толщина/обводки) — на вкус художника, придерживаясь минимализма и высокой читаемости.
- Визуальный намёк на тир крафта (опционально: тонкая кайма/форма основания).
- Яркость/длина импульса сети и плотность тумана — cмотрим по читаемости.

Все ключевые решения для визуала:
- Энергия — ярко-жёлтая (#FFD300), линии 0.25 м, импульс ×2 ярче, ~8 гексов.
- Мир — тёмно-тёплый, набор A по материалам, тёплый цветокор, слабый bloom/туман.
- Башни — каменное основание + металл/медь, рост +4% высота/+8% ширина на уровень (крафт-0), детали: резервуары/швы/локальные кристаллы.
- Враги — треугольные силуэты, 3 стадии поломки, тёплый/холодный отлив как подсказка резистов.
- VFX типов урона — как в палитре (оранж/фиолет/бело-голубой/светло-голубой/зелёный).
- UI — минимализм, книга рецептов 4 колонки, маркеры крафта (жёлтая руна), оверлей сети по кнопке.
